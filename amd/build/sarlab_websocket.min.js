define(["jquery"],function(){var a,b={SarlabWebSocket:function(b,c,d,e,f,g,h,i){a=new WebSocket("ws://127.0.0.1:8887"),a.onopen=function(){a.send("Message to send \r\n"),a.connectExperience(b,c,d,e,f,g,h,i),console.log("Connected to Sarlab experience: "+e)},a.onmessage=function(a){console.log("Message from Sarlab server: "+a.data)},a.onerror=function(){1!==a.readyState&&2!==a.readyState||a.send("exit"),alert("You need to download, install and/or run the Sarlab service.");var b=document.createElement("a");b.download="myDiscovery_win64.exe",b.href="http://enlargeirs.dia.uned.es/assets/install_myDiscovery_win64.exe",b.target="_blank",document.body.appendChild(b),b.click(),document.body.removeChild(b)},a.onclose=function(){console.log("Connection has been closed.")}},connectExperience:function(b,c,d,e,f,g,h,i){var j='{"command":"'+b+'","ip_server":"'+c+'","port_server":"'+d+'","id_exp":"'+e+'","expiration_time":"'+f+'","user":"'+g+'","password":"'+h+'"';"execjar"===b&&(j+=',"jar_file":"'+i+'"'),j+="}",a.send(j)},stopExperience:function(){a.send('{"command":"exit"}')},stopExperienceOnLeave:function(){window.onbeforeunload=function(){a.resetExperience(),a.stopExperience()}},resetExperience:function(){a.send('{"command":"reset"}')}};return b});