define ("mod_ejsapp/sarlab_websocket",["jquery"],function(){var b;return{SarlabWebSocket:function SarlabWebSocket(a,c,d,e,f,g,h,i){b=new WebSocket("ws://127.0.0.1:8887");b.onopen=function(){b.send("Message to send \r\n");b.connectExperience(a,c,d,e,f,g,h,i);console.log("Connected to Sarlab experience: "+e)};b.onmessage=function(a){console.log("Message from Sarlab server: "+a.data)};b.onerror=function(){if(1===b.readyState||2===b.readyState){b.send("exit")}alert("You need to download, install and/or run the Sarlab service.");var c=document.createElement("a");c.download="myDiscovery_win64.exe";c.href="http://enlargeirs.dia.uned.es/assets/install_myDiscovery_win64.exe";c.target="_blank";document.body.appendChild(c);c.click();document.body.removeChild(c)};b.onclose=function(){console.log("Connection has been closed.")}},connectExperience:function connectExperience(a,c,d,e,f,g,h,i){var j="{\"command\":\""+a+"\",\"ip_server\":\""+c+"\",\"port_server\":\""+d+"\",\"id_exp\":\""+e+"\",\"expiration_time\":\""+f+"\",\"user\":\""+g+"\",\"password\":\""+h+"\"";if("execjar"===a){j+=",\"jar_file\":\""+i+"\""}j+="}";b.send(j)},stopExperience:function stopExperience(){b.send("{\"command\":\"exit\"}")},stopExperienceOnLeave:function stopExperienceOnLeave(){window.onbeforeunload=function(){b.resetExperience();b.stopExperience()}},resetExperience:function resetExperience(){b.send("{\"command\":\"reset\"}")}}});
//# sourceMappingURL=sarlab_websocket.min.js.map
